<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Lucid</title>
	</head>
	<body>
		<header>
			<div id="brand">
				<img src="/images/icon-transparent.png" alt="Lucid" id="logo" />
				<h1>Lucid</h1>
			</div>
		<div id="header-right">
			<div id="status">
				<span id="status-dot"></span>
				<span id="status-text">Offline</span>
			</div>
			<button id="settings-btn" title="Settings" aria-label="Settings">
				<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
					<circle cx="12" cy="12" r="3"/>
				</svg>
			</button>
		</div>
		</header>

		<div id="onboarding">
			<img src="/images/icon-transparent.png" alt="Lucid" id="onboarding-logo" />
			<h2>Welcome to Lucid</h2>
			<p id="onboarding-desc">Choose how you'd like to power your page summaries.</p>
			<div id="onboarding-choices">
				<button class="choice-card" id="choose-local">
					<span class="choice-icon">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M9 9h6M9 13h6M9 17h3"/></svg>
					</span>
					<span class="choice-title">Local model</span>
					<span class="choice-desc">Runs entirely in your browser. Downloads a ~1 GB model on first use. No API key needed.</span>
				</button>
				<button class="choice-card" id="choose-provider">
					<span class="choice-icon">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
					</span>
					<span class="choice-title">OpenAI-compatible API</span>
					<span class="choice-desc">Connect to an external provider. Requires an API key and endpoint URL.</span>
				</button>
			</div>
		</div>

		<div id="loading" class="hidden">
			<img src="/images/icon-transparent.png" alt="Lucid" id="loading-logo" />
			<h2>Loading model</h2>
			<p id="progress-pct">0%</p>
			<div class="progress-track">
				<div id="progress-bar"></div>
			</div>
			<p id="progress-text">Initializing...</p>
			<div id="loading-retry" class="hidden">
				<button id="loading-settings-btn">Back to Settings</button>
			</div>
		</div>

		<div id="chat" class="hidden">
			<div id="messages"></div>

			<div id="actions">
				<button id="summarize">Summarize page</button>
				<button id="clear">Clear</button>
			</div>

			<div id="input-area">
				<textarea id="input" rows="1" placeholder="Ask about this page..."></textarea>
				<button id="send">Send</button>
			</div>
		</div>

		<div id="settings" class="hidden">
			<h2>Settings</h2>
			<div class="setting-group">
				<label class="toggle-label">
					<span>Use OpenAI-compatible provider</span>
					<input type="checkbox" id="use-provider" />
					<span class="toggle-switch"></span>
				</label>
			</div>
			<div id="local-mode-info">
				<div id="local-mode-header">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M9 9h6M9 13h6M9 17h3"/></svg>
					<div>
						<p id="local-mode-title">Local model</p>
						<p id="local-mode-desc">Runs entirely in your browser. No data leaves your device.</p>
					</div>
				</div>
				<div id="local-model-list"></div>
			</div>
			<div id="provider-fields" class="hidden">
				<!-- Connection card -->
				<div class="provider-card">
					<div class="provider-card-header">
						<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
						<span>Connection</span>
					</div>
					<div class="provider-card-body">
						<div class="setting-group">
							<label for="provider-url">API Base URL</label>
							<input type="url" id="provider-url" placeholder="https://api.openai.com/v1" />
						</div>
						<div class="setting-group">
							<label for="provider-key">API Key</label>
							<div class="input-with-icon">
								<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></svg>
								<input type="password" id="provider-key" placeholder="sk-..." />
							</div>
						</div>
						<div id="test-connection">
							<button id="test-btn">
								<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
								Test connection
							</button>
							<span id="test-result"></span>
						</div>
					</div>
				</div>
				<!-- Model card -->
				<div class="provider-card">
					<div class="provider-card-header">
						<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
						<span>Model</span>
					</div>
					<div class="provider-card-body">
						<div class="setting-group">
							<div id="model-selector">
								<select id="provider-model-select" disabled>
									<option value="" disabled selected>Fetch models first</option>
								</select>
								<button id="fetch-models-btn" title="Fetch available models" aria-label="Fetch models">
									<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>
								</button>
							</div>
							<span id="model-status"></span>
						</div>
						<div class="provider-divider"></div>
						<label class="toggle-label model-custom-toggle">
							<span>Use custom model name</span>
							<input type="checkbox" id="use-custom-model" />
							<span class="toggle-switch"></span>
						</label>
						<input type="text" id="provider-model-custom" class="hidden" placeholder="e.g. gpt-4o, llama-3.1-70b" />
					</div>
				</div>
			</div>
			<div class="setting-actions">
				<button id="settings-save">Save</button>
				<button id="settings-cancel">Cancel</button>
			</div>
		</div>

		<script type="module" src="/src/main.js"></script>
	</body>
</html>
